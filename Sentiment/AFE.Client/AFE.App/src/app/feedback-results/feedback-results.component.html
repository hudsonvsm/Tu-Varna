<div *ngIf="isLoading" class="mt-5 w-100 d-flex flex-column justify-content-center align-items-center">
  <div class="text-center text-muted font-weight-light text-large">{{ 'FEEDBACK-RESULT' | translate }}</div>
    <!-- <spinner></spinner> -->
</div>

<div *ngIf="!isLoading">
  <div class="form-row">
    <div class="form-group col-8 mb-1">
      <h3>{{'FEEDBACK-RESULT' | translate}}</h3>
    </div>
    <div class="form-group col-4 mb-1 text-right">
      <button type="button" (click)="retrainModel()" class="btn btn-primary">
        <i class="fas fa-plus"></i> {{'RETRAIN_MODEL' | translate}}
      </button>
      <swal #retrainStart type="success" title="{{'RETRAIN_MODEL_START' | translate}}"
        html="{{'IT_WILL_TAKE_5' | translate}}">
      </swal>
      <swal #retrainError type="error" title="{{'RETRAIN_MODEL_FAILED' | translate}}"
        html="{{'SOMETHING_WENT_WRONG' | translate}}">
      </swal>
    </div>
  </div>

  <div class="form-group mt-3">
    <input class="form-control" type="text" (keyup)="applyFilter($event.target.value)"
      placeholder="{{'FILTER' | translate}}">
  </div>

  <table class="w-100 mat-elevation-z8 cdk-table" mat-table [dataSource]="dataSource">

    <!-- User Name Column -->
    <ng-container matColumnDef="userName">
      <th mat-header-cell *matHeaderCellDef>{{'USER_NAME' | translate}} </th>
      <td mat-cell *matCellDef="let element"> {{element.userName}} </td>
    </ng-container>

    <!-- Feedback Column -->
    <ng-container matColumnDef="text">
      <th mat-header-cell *matHeaderCellDef>{{'FEEDBACK' | translate}} </th>
      <td mat-cell *matCellDef="let element" class="w-50"> {{element.text}} </td>
    </ng-container>

    <!-- probability Column -->
    <ng-container matColumnDef="probability">
      <th mat-header-cell *matHeaderCellDef>{{'PROBABILITY' | translate}} </th>
      <td mat-cell *matCellDef="let element"> {{element.probability}} % </td>
    </ng-container>

    <!-- score Column -->
    <ng-container matColumnDef="score">
      <th mat-header-cell *matHeaderCellDef>{{'SCORE' | translate}} </th>
      <td mat-cell *matCellDef="let element"> {{element.score}} </td>
    </ng-container>

    <!-- Sentimnet Column -->
    <ng-container matColumnDef="sentiment">
      <th mat-header-cell *matHeaderCellDef>{{'SENTIMENT' | translate}} </th>
      <td mat-cell *matCellDef="let element">
        <i *ngIf="element.sentiment && element.score > 0.05"
          class="ion d-block ion-md-happy display-4 text-success"></i>
        <i *ngIf="!element.sentiment && element.score < -0.05" class="ion d-block ion-md-sad display-4 text-danger"></i>
        <i *ngIf="element.score >= -0.05 && element.score <= 0.05" class="far fa-meh display-4 text-secondary"></i>
      </td>

    </ng-container>

    <ng-container matColumnDef="Actions">
      <th mat-header-cell *matHeaderCellDef></th>
      <td class="text-right" class="text-right" mat-cell *matCellDef="let element">
        <div *ngIf="!element.sentToML">
          <button [swal]="confirmSwal" class="w-50 col-md-auto btn icon-btn md-btn-flat btn-success">
            <i class="fas fa-edit"></i>{{'CONFIRM' | translate}}
            <swal #confirmSwal title="{{'CONFIRM_SENTIMENT_QUESTION' | translate}}"
              html="{{'ARE_YOU_SURE_CONFIRM' | translate}}" type="warning" reverseButtons="true"
              [showCancelButton]="true" (confirm)="confirmSentiment(element, false)">
            </swal>
          </button>
          <button [swal]="denySwal" class="w-25 col-md-auto btn icon-btn md-btn-flat btn-danger">
            <i class="fas fa-trash"></i>{{'DENY' | translate}}
            <swal #denySwal title="{{'CONFIRM_SENTIMENT_QUESTION' | translate}}"
              html="{{'ARE_YOU_SURE_DENY' | translate}}" type="warning" reverseButtons="true" [showCancelButton]="true"
              (confirm)="confirmSentiment(element, true)">
            </swal>
          </button>
        </div>
        <div *ngIf="element.sentToML">
          {{'CONFIRM_SENTIMENT_IS' | translate}}
          <i *ngIf="element.confirmedSentiment" class="ion d-block ion-md-happy display-4 text-success"></i>
          <i *ngIf="!element.confirmedSentiment" class="ion d-block ion-md-sad display-4 text-danger"></i>
        </div>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>

  <mat-paginator class="mat-elevation-z8" [pageSizeOptions]="[15, 25, 50, 100]" showFirstLastButtons></mat-paginator>
</div>